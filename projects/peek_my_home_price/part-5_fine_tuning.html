<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Cseresznye">
<meta name="dcterms.date" content="2024-11-24">

<title>Peek My Home Price Part-5: Fine tuning – Adam Cseresznye</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon_lower_A.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b697eb10549dbab267b4169cc0aac045.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-d6f6a3df318ae731e7885b4e8bdb9d5b.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-BQF3JENT9N', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Peek My Home Price Part-5: Fine tuning – Adam Cseresznye">
<meta property="og:description" content="">
<meta property="og:site_name" content="Adam Cseresznye">
<meta name="twitter:title" content="Peek My Home Price Part-5: Fine tuning – Adam Cseresznye">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Adam Cseresznye</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../scientific_output.html"> 
<span class="menu-text">Scientific Output</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../articles.html"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/adamcseresznye"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/csenye22"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adam-cseresznye"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Peek My Home Price Part-5: Fine tuning</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Belgian Housing Market Insights</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Adam Cseresznye </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 24, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prepare-dataframe-before-modelling" id="toc-prepare-dataframe-before-modelling" class="nav-link active" data-scroll-target="#prepare-dataframe-before-modelling">Prepare dataframe before modelling</a>
  <ul class="collapse">
  <li><a href="#hyperparameter-tuning-using-optuna" id="toc-hyperparameter-tuning-using-optuna" class="nav-link" data-scroll-target="#hyperparameter-tuning-using-optuna">Hyperparameter tuning using Optuna</a></li>
  </ul></li>
  <li><a href="#retrain-using-the-best-parameters-and-predict" id="toc-retrain-using-the-best-parameters-and-predict" class="nav-link" data-scroll-target="#retrain-using-the-best-parameters-and-predict">Retrain using the best parameters and predict</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://images.unsplash.com/photo-1549407408-4b016f497e4d?q=80&amp;w=2070&amp;auto=format&amp;fit=crop&amp;ixlib=rb-4.0.3&amp;ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Photo by Christian Allard UnSplash</figcaption>
</figure>
</div>
<p>In Part 4, we established a robust cross-validation strategy to consistently assess our model’s performance across multiple data folds. We also identified and managed potential outliers in our dataset. Additionally, we explored diverse feature engineering methods, creating and evaluating informative features to enhance our model’s predictive capabilities.</p>
<p>In this final segment, we’ll optimize our hyperparameters using Optuna and end by evaluating the final model’s performance based on the test portion. Let’s dive in!</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can explore the project’s app on its <a href="https://peek-my-home-price.fly.dev/">website</a>. For more details, visit the <a href="https://github.com/adamcseresznye/peek_my_home_price">GitHub repository</a>.</p>
<p>Check out the series for a deeper dive: - <a href="https://adamcseresznye.github.io/blog/projects/peek_my_home_price/part-1_characterizing_the_data.html">Part 1: Characterizing the Data</a> - <a href="https://adamcseresznye.github.io/blog/projects/peek_my_home_price/part-2_building_a_baseline_model.html">Part 2: Building a Baseline Model</a> - <a href="https://adamcseresznye.github.io/blog/projects/peek_my_home_price/part-3_feature_selection.html">Part 3: Feature Selection</a> - <a href="https://adamcseresznye.github.io/blog/projects/peek_my_home_price/part-4_feature_engineering.html">Part 4: Feature Engineering</a> - <a href="https://adamcseresznye.github.io/blog/projects/peek_my_home_price/part-5_fine_tuning.html">Part 5: Fine-Tuning</a></p>
</div>
</div>
<div id="8e260a44-75c8-4731-98e9-faaea802ae6f" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sys.path.append(<span class="bu">str</span>(Path.cwd()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cc3c6a54-530c-4491-bb08-3dfc054d78a6" class="cell" data-editable="true" data-slideshow="{&quot;slide_type&quot;:&quot;&quot;}" data-tags="[]" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gc</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Any, List, Optional, Tuple</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> catboost</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lets_plot <span class="im">import</span> <span class="op">*</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lets_plot.mapping <span class="im">import</span> as_discrete</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics, model_selection</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm.notebook <span class="im">import</span> tqdm</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> helper <span class="im">import</span> pre_process, predict_model, train_model, utils</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>LetsPlot.setup_html()</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> optuna</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">

            <div id="6f9xDS"></div>
            <script type="text/javascript" data-lets-plot-script="library">
                if(!window.letsPlotCallQueue) {
                    window.letsPlotCallQueue = [];
                }; 
                window.letsPlotCall = function(f) {
                    window.letsPlotCallQueue.push(f);
                };
                (function() {
                    var script = document.createElement("script");
                    script.type = "text/javascript";
                    script.src = "https://cdn.jsdelivr.net/gh/JetBrains/lets-plot@v4.5.1/js-package/distr/lets-plot.min.js";
                    script.onload = function() {
                        window.letsPlotCall = function(f) {f();};
                        window.letsPlotCallQueue.forEach(function(f) {f();});
                        window.letsPlotCallQueue = [];
                        
                    };
                    script.onerror = function(event) {
                        window.letsPlotCall = function(f) {};    // noop
                        window.letsPlotCallQueue = [];
                        var div = document.createElement("div");
                        div.style.color = 'darkred';
                        div.textContent = 'Error loading Lets-Plot JS';
                        document.getElementById("6f9xDS").appendChild(div);
                    };
                    var e = document.getElementById("6f9xDS");
                    e.appendChild(script);
                })()
            </script>
            
</div>
</div>
<p>Up to this point, we’ve successfully gathered all the house advertisements from various sources. We’ve conducted data description, preselected features, established an effective data pre-processing pipeline, and identified the most suitable machine learning algorithm for this task. Additionally, we’ve engaged in feature engineering and carried out further feature selection to streamline our machine learning model. The final step, that’s yet to be done, involves fine-tuning the hyperparameters of our machine learning model, enhancing predictive accuracy while mitigating overfitting.</p>
<section id="prepare-dataframe-before-modelling" class="level1">
<h1>Prepare dataframe before modelling</h1>
<p>Let’s get our data ready for modeling by applying the “prepare_data_for_modelling” function as detailed in Part 4. A quick recap: this function carries out the subsequent actions to prepare a DataFrame for machine learning: 1. It randomly shuffles the DataFrame’s rows. 2. The ‘price’ column is transformed into the base 10 logarithm. 3. Categorical variable missing values are replaced with ‘missing value.’ 4. It divides the data into features (X) and the target (y). 5. Using LocalOutlierFactor, it identifies and removes outlier values.rFactor.</p>
<div id="238557b9-5614-470c-a654-24a87300eef1" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_parquet(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    Path.cwd().joinpath(<span class="st">"data"</span>).joinpath(<span class="st">"2023-10-01_Processed_dataset_for_NB_use.gzip"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> pre_process.prepare_data_for_modelling(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of X and y with outliers: (3660, 14), (3660,)
Shape of X and y without outliers: (3427, 14), (3427,)</code></pre>
</div>
</div>
<p>We’ll divide the data into training and testing sets. The training portion will be dedicated to hyperparameter tuning. It’s worth noting that, to guard against overfitting during hyperparameter tuning, we’ll implement cross-validation. This involves splitting the training set into subgroups for training and validation. The validation portion helps prevent overfitting, and the training continues until we achieve the desired performance. The test set will come into play later for evaluating our final model.</p>
<div id="abad7188-255c-4368-a465-89036ac474f9" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> model_selection.train_test_split(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    y,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    test_size<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span>utils.Configuration.seed,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Shape of X_train: </span><span class="sc">{</span>X_train<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">, Shape of X_test: </span><span class="sc">{</span>X_test<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Shape of X_train: (2741, 14), Shape of X_test: (686, 14)</code></pre>
</div>
</div>
<p>We’ll also create a handy helper function called <code>dumper</code>. This function enables us to save the best parameters discovered during tuning as a <code>.pickle</code> file, allowing us to load and utilize these parameters from the saved file at a later time.</p>
<div id="9fc7f748-f9af-463e-85f3-82dca4029cdb" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dumper(<span class="bu">file</span>: Any, name: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Pickle and save an object to a file.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    This function takes an object and a name, then uses the Pickle library to serialize</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">    and save the object to a file with the given name. The file is saved in binary mode ('wb').</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">        file (Any): The object to be pickled and saved.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">        name (str): The name of the file, including the file extension, where the object will be saved.</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">        None: This function does not return a value.</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">        To save an object to a file:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; my_data = [1, 2, 3]</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">        &gt;&gt;&gt; dumper(my_data, "my_data.pickle")</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Note:</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">        The file is saved in binary mode ('wb') to ensure compatibility and proper</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">        handling of binary data.</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    pickle.dump(<span class="bu">file</span>, <span class="bu">open</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">.pickle"</span>, <span class="st">"wb"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="hyperparameter-tuning-using-optuna" class="level2">
<h2 class="anchored" data-anchor-id="hyperparameter-tuning-using-optuna">Hyperparameter tuning using Optuna</h2>
<p>To identify the most optimal settings, we’ll leverage the Optuna library. The key hyperparameters under consideration are iterations, depth, learning_rate, random_strength, bagging_temperature, and others.</p>
<div id="da415f11-f41b-47f6-b1dc-b29827061363" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(trial: optuna.Trial) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Optuna objective function for tuning CatBoost hyperparameters.</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    This function takes an Optuna trial and explores hyperparameters for a CatBoost</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    model to minimize the Root Mean Squared Error (RMSE) using K-Fold cross-validation.</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    - trial (optuna.Trial): Optuna trial object for hyperparameter optimization.</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">    - float: Mean RMSE across K-Fold cross-validation iterations.</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">    Example use case:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">    # Create an Optuna study and optimize hyperparameters</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">    study = optuna.create_study(direction="minimize")</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">    study.optimize(objective, n_trials=100)</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co">    # Get the best hyperparameters</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co">    best_params = study.best_params</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    catboost_params <span class="op">=</span> {</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">"iterations"</span>: trial.suggest_int(<span class="st">"iterations"</span>, <span class="dv">10</span>, <span class="dv">1000</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"depth"</span>: trial.suggest_int(<span class="st">"depth"</span>, <span class="dv">1</span>, <span class="dv">8</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"learning_rate"</span>: trial.suggest_float(<span class="st">"learning_rate"</span>, <span class="fl">0.01</span>, <span class="dv">1</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"random_strength"</span>: trial.suggest_float(<span class="st">"random_strength"</span>, <span class="fl">1e-9</span>, <span class="dv">10</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"bagging_temperature"</span>: trial.suggest_float(<span class="st">"bagging_temperature"</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">"l2_leaf_reg"</span>: trial.suggest_int(<span class="st">"l2_leaf_reg"</span>, <span class="dv">2</span>, <span class="dv">30</span>),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"border_count"</span>: trial.suggest_int(<span class="st">"border_count"</span>, <span class="dv">1</span>, <span class="dv">255</span>),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"thread_count"</span>: os.cpu_count(),</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    optuna.logging.set_verbosity(optuna.logging.WARNING)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract feature names and data types</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># features = X.columns[~X.columns.str.contains("price")]</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># numerical_features = X.select_dtypes("number").columns.to_list()</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    categorical_features <span class="op">=</span> X.select_dtypes(<span class="st">"object"</span>).columns.to_list()</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a K-Fold cross-validator</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    CV <span class="op">=</span> model_selection.RepeatedKFold(</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>        n_splits<span class="op">=</span><span class="dv">10</span>, n_repeats<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span>utils.Configuration.seed</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> train_fold_index, val_fold_index <span class="kw">in</span> CV.split(X):</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>        X_train_fold, X_val_fold <span class="op">=</span> X.loc[train_fold_index], X.loc[val_fold_index]</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>        y_train_fold, y_val_fold <span class="op">=</span> y.loc[train_fold_index], y.loc[val_fold_index]</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create CatBoost datasets</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>        catboost_train <span class="op">=</span> catboost.Pool(</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>            X_train_fold,</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>            y_train_fold,</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>            cat_features<span class="op">=</span>categorical_features,</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>        catboost_valid <span class="op">=</span> catboost.Pool(</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>            X_val_fold,</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>            y_val_fold,</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>            cat_features<span class="op">=</span>categorical_features,</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Initialize and train the CatBoost model</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> catboost.CatBoostRegressor(<span class="op">**</span>catboost_params)</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>        model.fit(</span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>            catboost_train,</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>            eval_set<span class="op">=</span>[catboost_valid],</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>            early_stopping_rounds<span class="op">=</span>utils.Configuration.early_stopping_round,</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>            verbose<span class="op">=</span>utils.Configuration.verbose,</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>            use_best_model<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate OOF validation predictions</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>        valid_pred <span class="op">=</span> model.predict(X_val_fold)</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>        RMSE_score <span class="op">=</span> metrics.mean_squared_error(y_val_fold, valid_pred, squared<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> (</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>            X_train_fold,</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>            y_train_fold,</span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>            X_val_fold,</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>            y_val_fold,</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>            catboost_train,</span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>            catboost_valid,</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>            model,</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>            valid_pred,</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>        gc.collect()</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>        results.append(RMSE_score)</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Similar to Part 4, the hyperparameter optimization step was pre-computed due to the significant computational time needed. The results were saved rather than executed during notebook rendering to save time. However, note that the outcomes should remain unchanged.</p>
</div>
</div>
<div id="72511d93-ac86-431b-9814-e326510efba5" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>script echo skipping</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>study <span class="op">=</span> optuna.create_study(direction<span class="op">=</span><span class="st">"minimize"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>study.optimize(train_model.Optuna_Objective(X_train, y_train), n_trials<span class="op">=</span><span class="dv">100</span>, show_progress_bar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>dumper(study.best_params, <span class="st">"CatBoost_params"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>dumper(study.best_value, <span class="st">"CatBoost_value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Couldn't find program: 'echo'</code></pre>
</div>
</div>
<p>As shown below, Optuna found the best Out-Of-Fold (OOF) score using the selected parameters, which is 0.1060. Recall that in Part 4, our best OOF score was 0.1070, so this represents a modest improvement, albeit a slight one.</p>
<div id="2c0361af-7498-45f6-9a3e-271f04222c8d" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>catboost_params_optuna <span class="op">=</span> pd.read_pickle(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    Path.cwd().joinpath(<span class="st">"data"</span>).joinpath(<span class="st">"CatBoost_params.pickle"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f'The best OOF RMSE score of the hyperparameter tuning is </span><span class="sc">{</span>pd<span class="sc">.</span>read_pickle(Path.cwd().joinpath(<span class="st">"data"</span>).joinpath(<span class="st">"CatBoost_value.pickle"</span>))<span class="sc">:.4f}</span><span class="ss">.'</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The corresponding values: </span><span class="sc">{</span>catboost_params_optuna<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The best OOF RMSE score of the hyperparameter tuning is 0.1060.
The corresponding values: {'iterations': 956, 'depth': 7, 'learning_rate': 0.050050595110243595, 'random_strength': 7.110744896133362, 'bagging_temperature': 0.024119607385698107, 'l2_leaf_reg': 3, 'border_count': 205}</code></pre>
</div>
</div>
</section>
</section>
<section id="retrain-using-the-best-parameters-and-predict" class="level1">
<h1>Retrain using the best parameters and predict</h1>
<p>After obtaining the most optimal parameters, we can proceed to retrain our model using the entire dataset, excluding the test portion, of course. For this we can use the <code>train_catboost</code> as seen below.</p>
<div id="61fd5584-9129-4e84-8cd7-8a0a98cde2eb" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> train_catboost(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    X: pd.DataFrame, y: pd.Series, catboost_params: <span class="bu">dict</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> catboost.CatBoostRegressor:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Train a CatBoostRegressor model using the provided data and parameters.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">        X (pd.DataFrame): The feature dataset.</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">        y (pd.Series): The target variable.</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">        catboost_params (dict): CatBoost hyperparameters.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">        CatBoostRegressor: The trained CatBoost model.</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">    This function takes the feature dataset `X`, the target variable `y`, and a dictionary of CatBoost</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">    hyperparameters. It automatically detects categorical features in the dataset and trains a CatBoostRegressor</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">    model with the specified parameters.</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">        X, y = load_data()</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">        catboost_params = {</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">            'iterations': 1000,</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">            'learning_rate': 0.1,</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">            'depth': 6,</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">            # ... other hyperparameters ...</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">        }</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">        model = train_catboost(X, y, catboost_params)</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    categorical_features <span class="op">=</span> X.select_dtypes(<span class="st">"object"</span>).columns.to_list()</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    catboost_train <span class="op">=</span> catboost.Pool(</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        X,</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        y,</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>        cat_features<span class="op">=</span>categorical_features,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> catboost.CatBoostRegressor(<span class="op">**</span>catboost_params)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    model.fit(</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        catboost_train,</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        verbose<span class="op">=</span>utils.Configuration.verbose,</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ac60091e-4e62-4197-b85d-b6e03b8e9cf0" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> train_model.train_catboost(X_train, y_train, catboost_params_optuna)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Excellent! We’ve made good progress. Now, it’s time for the final evaluation of our dataset using the test set. We can use the <code>predict_catboost</code> function for this.</p>
<div id="b83af087-cd62-463e-9360-8a549505f9aa" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> predict_catboost(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    model: catboost.CatBoostRegressor,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    X: pd.DataFrame,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    thread_count: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    verbose: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Make predictions using a CatBoost model on the provided dataset.</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">        model (catboost.CatBoostRegressor): The trained CatBoost model.</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">        X (pd.DataFrame): The dataset for which predictions are to be made.</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">        thread_count (int, optional): The number of threads for prediction. Default is -1 (auto).</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co">        verbose (int, optional): Verbosity level. Default is None.</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="co">        np.ndarray: Predicted values.</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co">    This function takes a trained CatBoost model, a dataset `X`, and optional parameters for</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co">    specifying the number of threads (`thread_count`) and verbosity (`verbose`) during prediction.</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">    It returns an array of predicted values.</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co">        model = load_catboost_model()</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">        X_new = load_new_data()</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">        predictions = predict_catboost(model, X_new, thread_count=4, verbose=2)</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    prediction <span class="op">=</span> model.predict(data<span class="op">=</span>X, thread_count<span class="op">=</span>thread_count, verbose<span class="op">=</span>verbose)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prediction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To assess the predictions, we’ll obtain both RMSE and R2 values.</p>
<div id="35088904-5cc3-4e75-ae3f-76617f17d49b" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="op">=</span> predict_model.predict_catboost(model<span class="op">=</span>model, X<span class="op">=</span>X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="25f3727e-ce09-4d5e-ac18-5542e92e1c21" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> score_prediction(y_true, y_pred):</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate regression evaluation metrics based on</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">    true and predicted values.</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Parameters:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">        y_true (array-like): True target values.</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">        y_pred (array-like): Predicted values.</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">        tuple: A tuple containing Root Mean Squared Error (RMSE)</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">        and R-squared (R2).</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">    This function calculates RMSE and R2 to evaluate the goodness</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">    of fit between the true target values and predicted values.</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">    Example:</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co">        y_true = [3, 5, 7, 9]</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">        y_pred = [2.8, 5.2, 7.1, 9.3]</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">        rmse, r2 = score_prediction(y_true, y_pred)</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    RMSE <span class="op">=</span> np.sqrt(metrics.mean_squared_error(y_true, np.log10(y_pred)))</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    R2 <span class="op">=</span> metrics.r2_score(y_true, y_pred)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> RMSE, R2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Superb! As you can see, the test set has an RMSE of 0.1101 and an R2 of 0.877. It’s worth noting that the test set’s RMSE is slightly higher than that of the training set, which is expected and suggests overfitting. Despite our efforts to prevent overfitting, it can be challenging to eliminate entirely. Nevertheless, it appears that we’ve done well.</p>
<div id="cea70430-d780-4506-9199-86a800f40d86" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>predict_model.score_prediction(y_pred<span class="op">=</span>prediction, y_true<span class="op">=</span>y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(0.1101569172024175, 0.8771378054646048)</code></pre>
</div>
</div>
<p>Let’s put the original values and prediction in a DataFrame so that we can evaluate them visually as well.</p>
<div id="d1c330fd-2457-4025-9153-5e726b2b1012" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> (</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    pd.concat(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        [y_test.reset_index(drop<span class="op">=</span><span class="va">True</span>), pd.Series(prediction)], axis<span class="op">=</span><span class="st">"columns"</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    ).rename(columns<span class="op">=</span>{<span class="st">"price"</span>: <span class="st">"original_values"</span>, <span class="dv">0</span>: <span class="st">"predicted_values"</span>})</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># .apply(lambda x: 10**x)</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    .assign(residuals<span class="op">=</span><span class="kw">lambda</span> df: df.original_values <span class="op">-</span> df.predicted_values)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>results</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">original_values</th>
<th data-quarto-table-cell-role="th">predicted_values</th>
<th data-quarto-table-cell-role="th">residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5.201397</td>
<td>5.198018</td>
<td>0.003380</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>5.445604</td>
<td>5.352777</td>
<td>0.092827</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>6.040998</td>
<td>6.023609</td>
<td>0.017389</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>6.021189</td>
<td>6.137714</td>
<td>-0.116525</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.911158</td>
<td>5.862038</td>
<td>0.049119</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">681</td>
<td>5.812913</td>
<td>5.776833</td>
<td>0.036081</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">682</td>
<td>5.755875</td>
<td>5.678560</td>
<td>0.077315</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">683</td>
<td>5.290035</td>
<td>5.193649</td>
<td>0.096385</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">684</td>
<td>5.542825</td>
<td>5.545253</td>
<td>-0.002428</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">685</td>
<td>5.475671</td>
<td>5.543814</td>
<td>-0.068143</td>
</tr>
</tbody>
</table>

<p>686 rows × 3 columns</p>
</div>
</div>
</div>
<p>As depicted below, our model demonstrates the ability to generalize effectively for unseen data, showcasing high R2 values and low RMSE. Additionally, examining the residuals reveals an even distribution, symbolizing robust model performance.</p>
<div id="cell-fig-fig1" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    results.pipe(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">lambda</span> df: ggplot(df, aes(<span class="st">"original_values"</span>, <span class="st">"predicted_values"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> geom_point()</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> geom_smooth()</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> geom_text(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="fl">6.6</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="ss">f"RMSE = </span><span class="sc">{</span>predict_model<span class="sc">.</span>score_prediction(y_pred<span class="op">=</span>prediction, y_true<span class="op">=</span>y_test)[<span class="dv">0</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            fontface<span class="op">=</span><span class="st">"bold"</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> geom_text(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="fl">4.965</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="fl">6.5</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span><span class="ss">f"R2 = </span><span class="sc">{</span>predict_model<span class="sc">.</span>score_prediction(y_pred<span class="op">=</span>prediction, y_true<span class="op">=</span>y_test)[<span class="dv">1</span>]<span class="sc">:.4f}</span><span class="ss">"</span>,</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            fontface<span class="op">=</span><span class="st">"bold"</span>,</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> labs(</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            title<span class="op">=</span><span class="st">"Contrasting Predicted House Prices with Actual House Prices"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>            subtitle<span class="op">=</span><span class="st">""" The plot suggests that the model makes accurate predictions on the test data. This is evident from the low RMSE values, </span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="st">            signifying a high level of accuracy. Additionally, the high R2 value indicates that the model effectively accounts for a </span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="st">            substantial portion of the data's variance, demonstrating a strong alignment between the model's predictions and the actual data.</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="st">            """</span>,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>            x<span class="op">=</span><span class="st">"log10 True Prices (EUR)"</span>,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>            y<span class="op">=</span><span class="st">"log10 Predicted Prices (EUR)"</span>,</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> theme(</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            plot_subtitle<span class="op">=</span>element_text(</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>                size<span class="op">=</span><span class="dv">12</span>, face<span class="op">=</span><span class="st">"italic"</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>            ),  <span class="co"># Customize subtitle appearance</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>            plot_title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">15</span>, face<span class="op">=</span><span class="st">"bold"</span>),  <span class="co"># Customize title appearance</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> ggsize(<span class="dv">800</span>, <span class="dv">600</span>)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fig1" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="16">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
   <div id="AakcjM"></div>
   <script type="text/javascript" data-lets-plot-script="plot">
   
   (function() {
   // ----------
   
   var containerDiv = document.getElementById("AakcjM");
   var observer = new ResizeObserver(function(entries) {
       for (let entry of entries) {
           var width = containerDiv.clientWidth
           if (entry.contentBoxSize && width > 0) {
           
               // Render plot
               if (observer) {
                   observer.disconnect();
                   observer = null;
               }

               var plotSpec={
"data":{
"original_values":[5.201397124320452,5.445604203273597,6.040997692423491,6.021189299069938,5.911157608739977,5.841984804590114,5.47567118832443,6.276461804173244,5.929418925714293,5.077367905284157,5.9164539485499255,6.105510184769974,5.396199347095736,5.413299764081252,5.173186268412274,5.439332693830263,5.826074802700826,5.681241237375588,5.252853030979893,5.252853030979893,5.021189299069938,6.095169351431755,5.230448921378274,5.217483944213907,5.619615005742807,5.264817823009537,5.77451696572855,5.977723605288848,5.77451696572855,5.617000341120899,5.298853076409706,5.698970004336019,6.089905111439398,5.9003671286564705,6.254064452914338,5.7774268223893115,5.423245873936808,5.694605198933568,5.47567118832443,5.997823080745725,5.6875289612146345,5.227886704613674,6.276461804173244,5.469822015978163,5.54282542695918,5.110589710299249,5.7596678446896306,5.568201724066995,5.332438459915605,6.36078268987328,5.056904851336473,5.108903127667313,5.380211241711606,5.431363764158987,5.585460729508501,6.102090525511836,5.69810054562339,5.298853076409706,5.350248018334163,6.161068385471174,5.661812685537261,5.628388930050312,6.146128035678238,5.447158031342219,5.7596678446896306,5.525044807036846,5.977723605288848,5.590507462008583,5.997823080745725,5.276461804173244,6.077367905284157,5.423245873936808,6.071882007306125,5.600972895686748,5.173186268412274,6.112269768417271,5.350248018334163,5.653212513775344,5.671172842715083,5.537819095073274,5.770852011642144,5.190331698170292,5.69810054562339,5.278753600952829,5.423245873936808,5.676693609624866,5.578639209968072,5.378397900948138,5.361727836017593,6.174641192660449,5.724275869600789,5.252853030979893,5.6127838567197355,5.498310553789601,6.319896858814888,5.525044807036846,5.4623979978989565,5.361727836017593,6.1303337684950066,5.942008053022313,5.690196080028514,5.981818607170664,5.555094448578319,5.585460729508501,5.423245873936808,5.680335513414564,5.6950436588212945,4.929418925714293,5.652246341003323,5.505149978319906,5.977723605288848,5.389166084364533,5.537819095073274,5.525044807036846,5.5532760461371,5.8095597146352675,5.812913356642856,5.523746466811565,5.694605198933568,5.638489256954637,5.517195897949974,5.217483944213907,5.6512780139981444,5.8061799739838875,5.661812685537261,5.47567118832443,5.423245873936808,5.993436230497612,5.204119982655925,5.511883360978874,5.6674529528899535,5.517195897949974,5.079181246047625,5.54282542695918,5.740361899867195,5.77451696572855,5.175801632848279,5.217483944213907,5.45484486000851,5.694605198933568,5.491361693834273,5.812913356642856,5.652246341003323,5.298853076409706,5.298853076409706,5.380211241711606,5.146128035678238,5.77451696572855,5.544068044350276,5.041392685158225,5.378397900948138,5.290034611362518,5.517195897949974,5.600972895686748,5.037426497940624,5.350248018334163,5.173186268412274,5.739572344450092,6.220108088040055,5.903089986991944,5.049218022670182,5.243038048686294,5.47567118832443,5.9614210940664485,5.252853030979893,5.724275869600789,5.812913356642856,5.926856708949693,5.5910646070264995,6.6429588794097905,5.4623979978989565,5.628388930050312,5.469822015978163,5.951823035315912,5.6180480967120925,4.977723605288848,5.204119982655925,5.434568904034199,5.060697840353612,5.845098040014257,5.574031267727719,5.685293781386784,5.648360010980932,5.276461804173244,5.544068044350276,5.600972895686748,5.5434471800817,5.954242509439325,5.812244696800369,5.77451696572855,5.633468455579586,5.622214022966295,5.56643749219507,5.653212513775344,5.352182518111363,5.445604203273597,5.204119982655925,5.578639209968072,5.460897842756548,5.2405492482825995,5.175801632848279,5.623249290397901,5.997823080745725,5.2552725051033065,5.503790683057181,5.079181246047625,6.079181246047625,5.217483944213907,5.648360010980932,5.489958479424835,5.748188027006201,5.628388930050312,5.837588438235511,5.812913356642856,4.99563519459755,5.252853030979893,5.778151250383644,5.795184589682424,5.681241237375588,5.1303337684950066,5.423245873936808,5.802773725291976,5.574031267727719,5.53135116458306,5.5301996982030825,5.474216264076255,5.371067862271736,5.643452676486188,5.203848463746235,6.371067862271736,5.217483944213907,5.568201724066995,5.574031267727719,5.380211241711606,5.298853076409706,5.491361693834273,5.748188027006201,5.977723605288848,5.755112266395071,5.8095597146352675,5.352182518111363,6.060697840353612,5.596597095626461,5.096910013008056,5.423245873936808,5.989004615698537,5.429752280002408,5.371067862271736,5.45484486000851,6.342422680822207,5.7626785637274365,5.477121254719663,6.143014800254095,5.585460729508501,5.389166084364533,5.565257343420214,5.469822015978163,5.7558748556724915,5.638489256954637,5.021189299069938,5.7619278384205295,5.267171728403014,5.860338006570994,5.041392685158225,5.694605198933568,5.894869656745253,5.361727836017593,5.378397900948138,5.600972895686748,5.361727836017593,5.47567118832443,5.437750562820388,6.201397124320452,5.143014800254095,5.57978359661681,5.371067862271736,5.243038048686294,4.949390006644912,5.574031267727719,5.518513939877887,5.311753861055754,5.112269768417271,5.544068044350276,5.740362689494244,5.429752280002408,5.9164539485499255,6.112269768417271,5.176091259055681,5.937016107464814,5.5301996982030825,5.658011396657113,5.975431808509263,5.724275869600789,5.2552725051033065,5.6523430550627145,5.567026366159061,5.4065401804339555,5.838849090737256,5.190331698170292,5.812913356642856,5.267171728403014,5.714329759745233,5.252853030979893,5.469822015978163,4.99563519459755,5.562292864456475,5.676693609624866,5.719289844693328,5.73996769675951,5.537819095073274,5.396199347095736,5.173186268412274,5.252853030979893,5.146128035678238,5.075546961392531,5.439332693830263,5.54282542695918,5.653212513775344,6.039414119176137,5.57978359661681,5.596597095626461,5.60151678365001,6.041392685158225,5.243038048686294,5.652246341003323,5.565696733446075,5.9003671286564705,5.230448921378274,5.505149978319906,5.841984804590114,6.216165902285993,5.380211241711606,5.342422680822207,5.54282542695918,5.267171728403014,5.544068044350276,5.8444771757456815,5.517195897949974,5.929418925714293,5.544068044350276,5.628388930050312,5.230448921378274,5.143014800254095,5.77451696572855,5.544068044350276,5.829303772831025,5.371067862271736,5.902546779313991,5.176091259055681,6.249198357391113,5.9003671286564705,5.413299764081252,6.173186268412274,5.173186268412274,4.954242509439325,6.2552725051033065,5.396199347095736,5.694605198933568,5.662757831681574,5.5301996982030825,5.445604203273597,5.342422680822207,5.7774268223893115,5.429752280002408,5.977723605288848,5.190331698170292,5.505149978319906,5.562292864456475,5.600972895686748,5.460897842756548,5.841984804590114,5.204119982655925,5.243038048686294,5.28443073384452,4.949390006644912,5.5910646070264995,5.77451696572855,5.396199347095736,5.552668216112194,5.515873843711679,5.445604203273597,5.970811610872518,5.99563519459755,5.384711742938283,5.47567118832443,5.596597095626461,5.510545010206612,5.359835482339888,5.77451696572855,5.173186268412274,5.460897842756548,5.447158031342219,5.110589710299249,5.3404441148401185,5.627365856592733,5.652246341003323,6.146128035678238,5.439332693830263,5.628388930050312,6.544068044350276,5.997823080745725,5.600972895686748,6.371067862271736,5.77451696572855,5.541579243946581,5.9003671286564705,5.525044807036846,5.201397124320452,5.676693609624866,5.596597095626461,5.648360010980932,5.841984804590114,5.628388930050312,5.385606273598312,6.371067862271736,5.77451696572855,5.431363764158987,5.060697840353612,5.854306041801081,5.951823035315912,5.926856708949693,5.276461804173244,5.600972895686748,5.342422680822207,5.841984804590114,5.875032309461098,5.176091259055681,5.176091259055681,5.954242509439325,5.426511261364575,5.298853076409706,5.544068044350276,5.326335860928752,5.110589710299249,5.139879086401237,5.942008053022313,5.986771734266245,5.544068044350276,5.446381812222442,5.829303772831025,5.652246341003323,5.653212513775344,5.379305517750582,5.173186268412274,5.096910013008056,5.491361693834273,5.739572344450092,6.054995861529141,5.54282542695918,5.9164539485499255,5.685741738602264,6.174641192660449,5.929418925714293,5.498310553789601,4.8750612633917,5.57978359661681,5.937016107464814,6.079181246047625,5.378397900948138,5.76715586608218,5.694605198933568,5.359835482339888,6.318063334962762,5.359835482339888,6.295567099962479,5.173186268412274,5.5301996982030825,5.661812685537261,5.6674529528899535,5.397070549959409,5.514547752660286,5.298853076409706,5.176091259055681,5.359835482339888,5.217483944213907,5.439332693830263,5.298853076409706,5.376576957056512,5.76715586608218,5.9003671286564705,5.598790506763115,5.217483944213907,5.537819095073274,5.136720567156407,5.76715586608218,5.841984804590114,5.145817714491828,5.600972895686748,5.217483944213907,5.491361693834273,5.911157608739977,5.812244696800369,5.439332693830263,5.505149978319906,5.628388930050312,5.361727836017593,6.112269768417271,5.201397124320452,5.578639209968072,5.602005701124516,5.503790683057181,5.7363965022766426,5.113943352306837,6.278753600952829,5.445604203273597,5.267171728403014,5.841984804590114,5.1303337684950066,5.252853030979893,5.161368002234975,4.903089986991944,5.332438459915605,5.230448921378274,5.832508912706237,5.993436230497612,5.7363965022766426,5.5301996982030825,5.110589710299249,5.342422680822207,5.889301702506311,5.6674529528899535,5.77451696572855,6.276461804173244,5.429752280002408,5.060697840353612,5.45484486000851,5.2027606873932,5.429752280002408,5.977723605288848,5.096910013008056,4.99563519459755,5.585460729508501,5.474216264076255,5.144574207609616,5.45484486000851,5.389166084364533,5.677515704798758,5.574031267727719,6.168792020314182,5.623249290397901,5.596597095626461,4.99563519459755,5.648360010980932,5.628388930050312,5.396199347095736,5.596597095626461,5.829303772831025,5.173186268412274,5.53135116458306,5.54282542695918,5.041392685158225,5.45484486000851,5.517195897949974,5.623249290397901,5.770852011642144,6.201397124320452,5.77451696572855,6.021189299069938,5.77451696572855,6.458637849025649,6.0603200286882855,6.190331698170292,6.212187604403958,5.601951404133522,5.45484486000851,5.378397900948138,5.54282542695918,5.653212513775344,5.567026366159061,5.9003671286564705,5.69810054562339,6.096910013008056,5.525044807036846,5.4048337166199385,5.6006135561423145,7.041392685158225,5.243038048686294,5.860338006570994,5.176091259055681,5.676693609624866,5.841984804590114,5.6127838567197355,5.711807229041191,5.740362689494244,5.511883360978874,5.537819095073274,5.252853030979893,6.254064452914338,5.531478917042255,5.511883360978874,5.290034611362518,5.812913356642856,5.600972895686748,5.060697840353612,5.672005445022952,5.037426497940624,5.585460729508501,5.795184589682424,5.694605198933568,5.503790683057181,5.574031267727719,5.928907690243952,5.561485397401995,5.69810054562339,5.361727836017593,5.173186268412274,5.439332693830263,5.6875289612146345,5.342422680822207,5.39776625612645,5.929418925714293,5.770115294787102,5.6464037262230695,5.276461804173244,5.76715586608218,5.872156272748293,5.229169702539101,5.477121254719663,5.648360010980932,5.555094448578319,5.9164539485499255,5.8750612633917,5.113609151073028,5.740362689494244,5.929418925714293,5.445604203273597,6.077367905284157,5.739572344450092,5.096910013008056,5.1303337684950066,6.229169702539101,5.359835482339888,5.469822015978163,5.661812685537261,4.99563519459755,5.643452676486188,5.9003671286564705,5.929418925714293,5.096910013008056,5.902546779313991,5.617157665694944,5.812913356642856,5.45484486000851,5.860338006570994,5.361727836017593,5.489958479424835,5.90200289135073,5.3404441148401185,6.144574207609616,5.6180480967120925,5.623249290397901,5.298853076409706,5.238046103128795,5.204119982655925,5.77451696572855,5.298853076409706,5.460897842756548,5.671172842715083,5.676693609624866,5.2552725051033065,5.439332693830263,5.252853030979893,5.444044795918076,5.342422680822207,5.413299764081252,5.271841606536499,5.600972895686748,5.460897842756548,5.812913356642856,5.201397124320452,5.429752280002408,5.556302500767287,5.544068044350276,5.845098040014257,5.928907690243952,5.913813852383717,6.439332693830263,5.653212513775344,5.1003705451175625,5.3979400086720375,5.505149978319906,5.812913356642856,5.7558748556724915,5.290034611362518,5.54282542695918,5.47567118832443],
"predicted_values":[5.198017583346747,5.352777437598908,6.023609158048497,6.137713882547114,5.8620383632430135,5.956277921734019,5.5535350741511875,6.146087411574098,5.88921026506747,5.10008717681639,5.822651520719825,5.982719504504639,5.336268161819687,5.403421690323308,5.08510651664321,5.3622272627529854,5.928859632734965,5.768289994159694,5.165511163053322,5.280435719136627,5.090187405502687,5.965403397787371,5.3233387212229015,5.336277972362316,5.721611338067426,5.704692601757591,6.07742979667367,5.889405852387379,5.628007917384083,5.554647130592206,5.440557514760086,5.547315346284626,6.004759741721686,5.8680508885078915,6.199486371438465,5.546089300633953,5.36347612176344,5.760900114566021,5.36162149541067,6.016044955262136,5.716223731956669,5.541758664561429,6.279694485507539,5.413325076002355,5.550008422807423,5.165959061286612,5.71245511715615,5.529961486885903,5.371293662766824,5.9440904595998365,5.146916087112651,5.206955216274487,5.384094632895634,5.441147990554912,5.565052118164606,5.991714401323557,5.597227579158822,5.310606147369211,5.2958121164793965,5.971181946332835,5.635706430318455,5.696031097521085,5.979707502657198,5.4320055157521745,5.783644001304042,5.466784136239073,5.9575266021108595,5.638799347350912,5.968575280630661,5.171921236456575,5.970765011671315,5.705476052192901,5.767761762972211,5.650196278371377,5.120724462431466,6.188062873810361,5.346930248983752,5.840205230989805,5.605567216427271,5.587496434737329,5.781912708317513,5.188101095395462,5.575980890792882,5.2280094630742235,5.475645169425742,5.64362698018977,5.645038059690255,5.417206976993192,5.084133716920452,6.369391902712625,5.72413810395866,5.203342597414071,5.709336217296337,5.3213063962684215,5.998291063025936,5.565409413213112,5.626060183755987,5.273608128166394,5.840016688312368,5.771053960694083,5.69348739318209,5.709622967365702,5.781568385174735,5.448965709525484,5.5598244129750185,5.46451551818865,5.7417342451523385,5.080227726213606,5.649745174446148,5.59762330392374,5.951244935476236,5.51911083028027,5.530708868305543,5.601713585694922,5.567521404320344,5.769104684872131,5.941614611216826,5.5668823790631174,5.522082648118855,5.620332700884624,5.501573514832586,5.165180654992431,5.600022245669818,5.9242416901347,5.605001558625751,5.639824221566237,5.391949760187745,6.163130432899817,5.176806975469519,5.454615496949427,5.645183796824524,5.5787064739288565,5.16523260123306,5.5620324205806515,5.668646300603935,5.695237547646805,5.234169696730729,5.253216529448627,5.382020395883666,5.675286143793546,5.397511139797798,5.6724354731415465,5.731793832440589,5.265589441142735,5.252591236286762,5.523952034163472,5.284953349710064,6.214088509208359,5.57457308362894,5.132896525270499,5.373001172650547,5.4631587091779155,5.572462319063994,5.507335029890791,5.024809845339182,5.428300820707567,5.332961921280063,5.732277512425799,6.164275669977843,5.9078833406867854,5.186989508675565,5.314312907986055,5.43893829905711,5.925751325238853,5.261711471035012,5.78417536953123,5.829065156307034,5.963635427639431,5.493078304125806,6.70681579535296,5.478656255043698,5.621854193713348,5.510674784684393,5.880551644583828,5.588211504833062,5.153694680282873,5.254718295325511,5.394195890652872,5.215341680430553,5.757788949651094,5.558195793459656,5.701773452148211,5.6113064129136365,5.330314968515697,5.560046894731406,5.575666023272752,5.603447596556163,6.107082859898615,5.825134325770681,5.76027503290314,5.583098143751556,5.671224928012176,5.584720027956888,5.715589546613673,5.269518556284456,5.483631470175581,5.324789586070667,5.620343217486969,5.4134114307309416,5.28631182053033,5.274822065955216,5.611039549754596,5.838194180444299,5.18621960059434,5.500178598405289,5.173685555022058,6.146230516627,5.20003430914506,5.517049320755662,5.4983462781977845,5.711578667433243,5.481909546884301,5.907569296090188,5.799119862440784,4.928808854011247,5.451221358854105,5.735738335488402,5.947428396340188,5.605267631326931,5.171458802306371,5.339004084590545,5.907504599266661,5.705235142028197,5.517046247923625,5.508976162934281,5.362747263812486,5.311910841237611,5.639579675596188,5.185693907879128,6.459265373910344,5.106870703703752,5.570443357652001,5.669184907490548,5.425438337741688,5.273133153371047,5.698651448550514,5.7618976332438,6.156519333571467,5.691533130971305,5.814563859157965,5.316108229579724,6.0496151913617116,5.470216133671353,5.154237942140793,5.550948813584717,6.003454359131398,5.369436264177484,5.397816420741005,5.56177887188529,6.279428475273905,5.857293329022074,5.4636075240043365,6.197010802159038,5.629215713102649,5.453598090856618,5.572188998679407,5.448162355880633,5.658242619752865,5.698847760084977,4.997453874768905,5.7446130689227655,5.257352802047809,5.817070153817085,5.2308886043988245,5.7981633373221095,5.91323766531743,5.34162113356189,5.275845610956187,5.630894629356396,5.423985424502534,5.602071631021028,5.417262519138885,6.1298289277668845,5.112233631785711,5.715482960901448,5.313469892924141,5.430860904339057,5.003216334604454,5.572138743002416,5.508516004882625,5.325955610461827,5.207993192666924,5.489792882299614,5.850864048886915,5.58824978666596,5.858199648888489,6.124444256591561,5.188418501505234,5.9060579901642525,5.527839333765918,5.679840436996017,5.928052111645805,5.735496953354869,5.188097761056061,5.652934095840561,5.5397311230918564,5.342737752841274,5.947748879108513,5.1410746076365275,5.908244258078245,5.362362017804158,5.717787511861751,5.247788137480146,5.460925553353683,5.301705453889825,5.51944723232358,5.691787549347657,5.639571268360179,5.721172141947082,5.361894530596403,5.481319413455112,5.332961921280063,5.298832026073857,5.214486281642191,5.385473410818085,5.415116667021319,5.515422392129923,5.562843756627692,6.088229107169351,5.779957366233711,5.476879292663629,5.628987654766308,5.94552526349642,5.255652203749406,5.720227658809648,5.526552082991632,5.868634533345379,5.25997769604785,5.442187438984401,5.753667414209078,6.018268684164322,5.334726343520323,5.362800026441242,5.509063204019241,5.265227548952146,5.587042965940035,5.815076952576418,5.572228460331092,5.902771120510603,5.544066066819803,5.604072297253942,5.249317753609979,5.151375356713036,5.757287642859538,5.569692396428292,5.933624776677919,5.536196421240205,6.143506343292934,5.196716918122939,6.295958977449999,5.923323051725628,5.424523400478829,6.257476562303869,5.205976081919858,4.99950597843359,6.016534591170305,5.361000256142883,5.737977497675629,5.703396173145867,5.557127323160546,5.429280180832224,5.207873789181113,5.756416594595246,5.4369599259387416,6.106002189575852,5.2025197626532345,5.450781925301626,5.528053275712209,5.6526573044594635,5.433931576782043,5.754625217583414,5.238750794285808,5.238416664375548,5.266475323219306,5.151751307080775,5.484292911979833,5.6624173266444835,5.387516166735628,5.542504569371797,5.394870438398621,5.296506086488534,5.969807980934295,5.915297371972488,5.338809328943679,5.417514816585042,5.577920399383912,5.576402251874571,5.189512824616152,5.7367250674103945,5.399514949432445,5.513298896593367,5.470397433104543,5.050692662416463,5.310289715101631,5.701594876611671,5.6767791911274745,6.138717004844734,5.5710715994003195,5.537025048158937,6.516693423575787,5.86969896375554,5.528691305283036,6.3755277482699615,5.789040288804759,5.516721617562723,6.018915973293321,5.503914200181409,5.217537027160943,5.395633933369193,5.79758148034431,5.406461449503686,5.741826039266559,5.711404434535311,5.363150700328368,6.448219523849274,5.981026346075805,5.521584978099806,5.063935532077486,5.866357758697052,5.728631039969817,6.134482939572457,5.245133617765642,5.631958650717137,5.447503621534745,5.682150410921199,5.959724963715657,5.299689642624567,5.25838648397475,6.138466880718244,5.321637213166788,5.628983465761611,5.58863309038215,5.35939618352678,5.265710393867689,5.317777705627043,6.092670336870084,5.763438800590446,5.597622137878272,5.515689051724562,5.640826925532147,5.713240710388141,5.574427789706389,5.41086759384935,5.184336113127033,5.385490301278289,5.397310355179095,5.807916713097449,5.779111968339291,5.64065971389792,5.97703300039612,5.640471120398952,5.946669595771708,5.809161797233743,5.529790335775809,4.960960075761029,5.678386832071933,5.770074337728096,6.221488634139354,5.350312485211146,5.936162664963831,5.647453618300168,5.296727668842039,6.081349744756868,5.2011943870616015,6.455156588086539,5.156701696799707,5.4666215925266695,5.600656086362176,5.786318965746873,5.332158930023389,5.575689716645086,5.236538354714582,5.301861524628997,5.308481420143049,5.270469131365785,5.357541838007442,5.208155878472712,5.319315295695196,5.780412960535951,6.019148587298271,5.514836128240111,5.246236501741301,5.531527918130423,5.19822346285706,5.7301915821699,5.824438465890068,5.156338586854264,5.502426181642596,5.33434177350717,5.449190933824984,5.867826276115864,5.759282076044046,5.518154392100389,5.585919848169958,5.424648404096696,5.443368004077762,5.651815632985891,5.307970306255479,5.559929380322825,5.550421555332423,5.4295769385650665,5.5812985175456635,5.287409248197765,5.897294531635131,5.467486287396651,5.263440925206874,5.618978740786313,5.11819118618609,5.305555596604865,5.2696211150960215,4.990351757091706,5.278072032754384,5.3830428029473465,5.684870441379438,6.086924384325609,5.723594333371643,5.4249585261985676,5.213896914801966,5.5053184552085375,5.787670409515331,5.842328446334215,5.65451777328368,6.217109764488271,5.493770973232106,5.28551100019914,5.536625205103072,5.271194314242116,5.416624721092199,6.39654496732134,5.040194945307258,5.101926864838111,5.582286729698577,5.4949765504409624,5.214680625094447,5.3773002346314485,5.276682476543924,5.652961708647674,5.483595796008277,6.188616877665897,5.583667038265964,5.503667187292799,5.070796908788482,5.611677211823913,5.761163693473181,5.4293164383480725,5.676928854998905,5.749799735956988,5.274384005036521,5.552860845044727,5.6333462123925395,5.121734148204886,5.670086409250256,5.577367025223131,5.590616521003858,5.730443953690298,6.148377004146984,5.742989285044884,5.881109717288328,5.867197086903931,6.703692274162019,5.854925385355717,6.1034912134712185,6.272369874049409,5.742516655090383,5.354411211832687,5.341064905152176,5.654979352995307,5.668830754084768,5.4022682145934855,6.154133485948788,5.872449964988526,6.154296204076071,5.52147651048124,5.405792603028328,5.72994648141281,6.89935014686972,5.253141611167397,5.861910672652937,5.131339461795893,5.594620474360187,5.80212584395581,5.634246090384568,5.648874329104871,5.759219124052448,5.93661751165039,5.4795722933091735,5.382069305304236,6.197878078157575,5.581680442435141,5.57274095554817,5.3194838127499455,5.824233210109293,5.639980740691873,5.060925532446114,5.9638315238308355,5.078588604267159,5.5237440386719285,5.947428396340188,5.615662461240563,5.585685328444879,5.674710518847244,5.831485367561527,5.529098293234901,5.550792554164723,5.464161400825264,5.113183684514184,5.457427672878463,5.82503985332181,5.451951444562301,5.179154200670942,5.856263294940783,5.758611782740409,5.667690225271999,5.156288677069836,5.774215792900317,5.839234546260816,5.204119394133439,5.362768050491922,5.594893821028335,5.781568385174735,5.921519289314543,5.735652335970908,5.145495582238634,5.783882491005601,5.9081501010890705,5.437296988195057,6.078815023485706,5.666565116098967,5.18913143717778,5.105329383710775,6.349415704880633,5.226602121637222,5.391683817592193,5.6684655579754475,5.173642144767373,5.70871199571034,5.923189337513152,5.9366635925081805,5.086107993519377,5.9727317575308065,5.709188054005443,5.78021969352419,5.519632076547831,6.033568702721866,5.397189350680977,5.586887885620073,5.950841741650754,5.365928124865139,6.1845258138096355,5.622083175437912,5.6637755527660065,5.368169942298264,5.547263607565205,5.385986442171129,5.790725846386913,5.313119031590197,5.5028534845695845,5.544608792507228,5.722242688972962,5.251370911711769,5.4294768481643,5.215605089001836,5.528837831951164,5.398568938073277,5.338398680815754,5.278559769402217,5.646150958299239,5.366796517905556,5.859148278316664,5.235176015888912,5.312772791508672,5.524467566908656,5.882173404635367,5.615625955860039,5.932581086351784,5.966591654743582,6.386344632868584,5.5669005974870815,5.091992938648918,5.274745674573215,5.418834483477004,5.776832808527544,5.6785601211789185,5.193649256502248,5.545253078550717,5.543813900358861]
},
"mapping":{
"x":"original_values",
"y":"predicted_values"
},
"data_meta":{
"series_annotations":[{
"type":"float",
"column":"original_values"
},{
"type":"float",
"column":"predicted_values"
},{
"type":"float",
"column":"residuals"
}]
},
"ggtitle":{
"text":"Contrasting Predicted House Prices with Actual House Prices",
"subtitle":" The plot suggests that the model makes accurate predictions on the test data. This is evident from the low RMSE values, \n            signifying a high level of accuracy. Additionally, the high R2 value indicates that the model effectively accounts for a \n            substantial portion of the data's variance, demonstrating a strong alignment between the model's predictions and the actual data.\n            "
},
"guides":{
"x":{
"title":"log10 True Prices (EUR)"
},
"y":{
"title":"log10 Predicted Prices (EUR)"
}
},
"theme":{
"plot_title":{
"face":"bold",
"size":15.0,
"blank":false
},
"plot_subtitle":{
"face":"italic",
"size":12.0,
"blank":false
}
},
"ggsize":{
"width":800.0,
"height":600.0
},
"kind":"plot",
"scales":[],
"layers":[{
"geom":"point",
"mapping":{
},
"data_meta":{
},
"data":{
}
},{
"geom":"smooth",
"mapping":{
},
"data_meta":{
},
"data":{
"..ymin..":[4.927255768057578,4.952795218615501,4.978330116488928,5.0038599754580275,5.029384242334826,5.054902286057649,5.080413384860043,5.105916711197485,5.131411314092702,5.156896098559321,5.182369801802468,5.207830966003595,5.233277907720211,5.258708684334698,5.284121058659274,5.309512463857677,5.3348799723957345,5.360220274861389,5.385529677147597,5.410804127325778,5.43603928570857,5.461230651587924,5.486373755838504,5.51146441803555,5.536499049687475,5.56147496499427,5.58639064491027,5.611245898676874,5.636041884736443,5.6607809858905735,5.685466568672776,5.710102679781674,5.7346937360218915,5.759244251584405,5.783758626650039,5.808241002840359,5.832695178584205,5.857124571586693,5.881532214603129,5.905920772464421,5.930292571061515,5.954649631751779,5.978993706939586,6.003326314291581,6.027648768228603,6.051962208103525,6.076267622943071,6.100565872897825,6.124857707680063,6.149143782323918,6.173424670610092,6.19770087647953,6.221972843730156,6.246240964256075,6.270505585053854,6.294767014187997,6.3190255258785815,6.343281364848576,6.367534750046388,6.39178587784062,6.416034924768336,6.440282049904888,6.464527396912458,6.488771095815179,6.513013264541141,6.537254010265127,6.561493430580669,6.585731614525527,6.609968643481044,6.6342045919626695,6.658439528316397,6.68267351533366,6.706906610795376,6.731138867954347,6.755370335963835,6.779601060259096,6.803831082897709,6.828060442863674,6.852289176339701,6.876517316951395],
"..ymax..":[4.966284982310939,4.990559961040777,5.014839492455108,5.0391240627737695,5.063414225184728,5.0877106107496655,5.112013941235032,5.136325044185349,5.160644870577892,5.184974515399031,5.209315241443645,5.233668506530275,5.258035994101419,5.282419646774692,5.306821701737876,5.331244725827231,5.355691646576934,5.380165773399039,5.4046708004005914,5.429210779510169,5.453790050415136,5.478413113823542,5.5030844388607205,5.527808205951435,5.552588003587269,5.5774265175682345,5.602325266939991,5.627284442461148,5.652302885689338,5.677378213822967,5.702507060328523,5.7276853785073865,5.752908751554927,5.778172665280173,5.803472719502299,5.828804772599738,5.854165026143652,5.8795500624289225,5.904956848700247,5.930382720126714,5.955825350817379,5.981282719414874,6.006753073514827,6.032234895450591,6.057726870801329,6.083227860214167,6.10873687466238,6.134253053995385,6.159775648500905,6.185304003144811,6.210837544146396,6.236375767564718,6.261918229601851,6.287464538363692,6.31301434685367,6.338567347007288,6.364123264604464,6.389681854922228,6.415242899012177,6.440806200505703,6.466371582865747,6.4919388870169525,6.517507969297143,6.543078699682181,6.568650960243979,6.594224643807752,6.61979965277997,6.645375898122871,6.670953298455113,6.696531779261248,6.722111272195279,6.747691714465777,6.773273048291819,6.798855220420607,6.82443818169888,6.850021886691377,6.875606293340525,6.901191362662318,6.92677705847405,6.952363347150117],
"original_values":[4.8750612633917,4.902483180122922,4.929905096854144,4.957327013585366,4.984748930316587,5.012170847047809,5.039592763779031,5.067014680510253,5.094436597241475,5.121858513972697,5.149280430703919,5.17670234743514,5.204124264166362,5.231546180897584,5.258968097628806,5.286390014360028,5.31381193109125,5.341233847822472,5.368655764553694,5.396077681284915,5.423499598016137,5.450921514747359,5.478343431478581,5.505765348209803,5.5331872649410245,5.5606091816722465,5.588031098403468,5.6154530151346895,5.6428749318659115,5.6702968485971335,5.697718765328355,5.725140682059577,5.752562598790799,5.77998451552202,5.807406432253242,5.834828348984464,5.862250265715686,5.889672182446908,5.91709409917813,5.944516015909352,5.971937932640573,5.999359849371795,6.026781766103017,6.054203682834239,6.081625599565461,6.109047516296683,6.136469433027905,6.163891349759126,6.191313266490348,6.21873518322157,6.246157099952792,6.273579016684014,6.301000933415236,6.328422850146458,6.355844766877679,6.383266683608901,6.410688600340123,6.438110517071345,6.465532433802567,6.492954350533789,6.520376267265011,6.547798183996232,6.575220100727454,6.602642017458676,6.630063934189898,6.65748585092112,6.684907767652342,6.712329684383564,6.739751601114785,6.767173517846007,6.794595434577229,6.8220173513084506,6.8494392680396725,6.876861184770894,6.904283101502116,6.9317050182333375,6.95912693496456,6.986548851695781,7.013970768427003,7.041392685158225],
"predicted_values":[4.946770375184259,4.971677589828139,4.996584804472018,5.0214920191158985,5.046399233759777,5.071306448403657,5.096213663047537,5.121120877691417,5.146028092335297,5.170935306979176,5.195842521623057,5.220749736266935,5.245656950910815,5.270564165554695,5.295471380198575,5.320378594842454,5.3452858094863345,5.370193024130214,5.395100238774094,5.420007453417973,5.444914668061853,5.469821882705733,5.494729097349612,5.519636311993493,5.544543526637372,5.569450741281252,5.594357955925131,5.619265170569011,5.64417238521289,5.6690795998567705,5.69398681450065,5.71889402914453,5.743801243788409,5.768708458432289,5.793615673076169,5.818522887720048,5.843430102363929,5.868337317007808,5.893244531651688,5.9181517462955675,5.943058960939447,5.967966175583326,5.992873390227206,6.017780604871086,6.042687819514966,6.067595034158846,6.092502248802726,6.117409463446605,6.142316678090484,6.1672238927343646,6.192131107378244,6.217038322022124,6.2419455366660035,6.266852751309884,6.291759965953762,6.316667180597642,6.341574395241523,6.366481609885402,6.391388824529282,6.416296039173162,6.441203253817042,6.46611046846092,6.4910176831048005,6.51592489774868,6.54083211239256,6.5657393270364395,6.59064654168032,6.615553756324199,6.640460970968078,6.665368185611959,6.690275400255838,6.715182614899718,6.740089829543598,6.764997044187477,6.789904258831357,6.8148114734752365,6.839718688119117,6.864625902762996,6.8895331174068755,6.914440332050756]
}
},{
"geom":"text",
"mapping":{
},
"data_meta":{
},
"x":5.0,
"y":6.6,
"label":"RMSE = 0.1102",
"fontface":"bold",
"data":{
}
},{
"geom":"text",
"mapping":{
},
"data_meta":{
},
"x":4.965,
"y":6.5,
"label":"R2 = 0.8771",
"fontface":"bold",
"data":{
}
}],
"metainfo_list":[],
"spec_id":"1"
};
               window.letsPlotCall(function() {
       
               var toolbar = null;
               var plotContainer = containerDiv;               
               
                   var options = {
                       sizing: {
                           width_mode: "min",
                           height_mode: "scaled",
                           width: width
                       }
                   };
                   var fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer, options);
                   if (toolbar) {
                     toolbar.bind(fig);
                   }
               });
               
               break;
           }
       }
   });
   
   observer.observe(containerDiv);
   
   // ----------
   })();
   
   </script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Contrasting Predicted House Prices with Actual House Prices
</figcaption>
</figure>
</div>
</div>
<div id="cell-fig-fig2" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    results.pipe(<span class="kw">lambda</span> df: ggplot(df, aes(<span class="st">"residuals"</span>)) <span class="op">+</span> geom_histogram(stat<span class="op">=</span><span class="st">"bin"</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> labs(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        title<span class="op">=</span><span class="st">"Assessing the Residuals from the Catboost Model"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        subtitle<span class="op">=</span><span class="st">""" Normally distributed residuals imply consistent and accurate model predictions, aligning with statistical assumptions.</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">            """</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span><span class="st">"Distribution of Residuals"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span><span class="st">""</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> theme(</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        plot_subtitle<span class="op">=</span>element_text(</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span><span class="dv">12</span>, face<span class="op">=</span><span class="st">"italic"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        ),  <span class="co"># Customize subtitle appearance</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        plot_title<span class="op">=</span>element_text(size<span class="op">=</span><span class="dv">15</span>, face<span class="op">=</span><span class="st">"bold"</span>),  <span class="co"># Customize title appearance</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> ggsize(<span class="dv">800</span>, <span class="dv">600</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-fig2" class="cell-output cell-output-display quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="17">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
   <div id="MGHSeN"></div>
   <script type="text/javascript" data-lets-plot-script="plot">
   
   (function() {
   // ----------
   
   var containerDiv = document.getElementById("MGHSeN");
   var observer = new ResizeObserver(function(entries) {
       for (let entry of entries) {
           var width = containerDiv.clientWidth
           if (entry.contentBoxSize && width > 0) {
           
               // Render plot
               if (observer) {
                   observer.disconnect();
                   observer = null;
               }

               var plotSpec={
"data":{
},
"mapping":{
"x":"residuals"
},
"data_meta":{
"series_annotations":[{
"type":"float",
"column":"original_values"
},{
"type":"float",
"column":"predicted_values"
},{
"type":"float",
"column":"residuals"
}]
},
"ggtitle":{
"text":"Assessing the Residuals from the Catboost Model",
"subtitle":" Normally distributed residuals imply consistent and accurate model predictions, aligning with statistical assumptions.\n            "
},
"guides":{
"x":{
"title":"Distribution of Residuals"
},
"y":{
"title":""
}
},
"theme":{
"plot_title":{
"face":"bold",
"size":15.0,
"blank":false
},
"plot_subtitle":{
"face":"italic",
"size":12.0,
"blank":false
}
},
"ggsize":{
"width":800.0,
"height":600.0
},
"kind":"plot",
"scales":[],
"layers":[{
"geom":"histogram",
"stat":"bin",
"mapping":{
},
"data_meta":{
},
"data":{
"..count..":[2.0,2.0,0.0,1.0,5.0,4.0,2.0,6.0,14.0,26.0,30.0,50.0,66.0,74.0,102.0,98.0,74.0,52.0,29.0,18.0,8.0,9.0,4.0,5.0,2.0,0.0,1.0,1.0,0.0,1.0],
"residuals":[-0.4451767156871108,-0.4137652402368506,-0.38235376478659033,-0.3509422893363301,-0.31953081388606985,-0.2881193384358096,-0.25670786298554943,-0.2252963875352892,-0.19388491208502895,-0.1624734366347687,-0.13106196118450847,-0.09965048573424823,-0.06823901028398804,-0.036827534833727804,-0.005416059383467564,0.025995416066792676,0.057406891517052916,0.08881836696731316,0.1202298424175734,0.15164131786783364,0.18305279331809388,0.21446426876835412,0.24587574421861436,0.2772872196688746,0.3086986951191347,0.34011017056939497,0.3715216460196552,0.40293312146991545,0.4343445969201757,0.4657560723704359]
}
}],
"metainfo_list":[],
"spec_id":"2"
};
               window.letsPlotCall(function() {
       
               var toolbar = null;
               var plotContainer = containerDiv;               
               
                   var options = {
                       sizing: {
                           width_mode: "min",
                           height_mode: "scaled",
                           width: width
                       }
                   };
                   var fig = LetsPlot.buildPlotFromProcessedSpecs(plotSpec, -1, -1, plotContainer, options);
                   if (toolbar) {
                     toolbar.bind(fig);
                   }
               });
               
               break;
           }
       }
   });
   
   observer.observe(containerDiv);
   
   // ----------
   })();
   
   </script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Assessing the Residuals from the Catboost Model
</figcaption>
</figure>
</div>
</div>
<p>And there you have it! We reached the end of these series! 🥳🎆🎉🍾🍻🕺</p>
<p>Over these five articles, we’ve shown how to build a reliable, high-performing machine learning model for real-time house price prediction. While there’s always room for improvement, like exploring geolocation-based feature engineering, blending, and stacking, our aim was to provide a comprehensive guide from start to finish. We hope you’ve enjoyed this journey and gained inspiration and insights for your own projects.</p>
<p>Until next time! 💻🐍🐼</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/adamcseresznye\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Adam Cseresznye</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>